---
# ğŸ§¹ Desinstalar Jenkins de Kubernetes usando Ansible

- name: Desinstalar Jenkins de Kubernetes
  hosts: controller
  gather_facts: false
  vars_files:
    - ../group_vars/all.yml
  environment:
    PATH: "/usr/local/bin:/usr/bin:/bin:/usr/sbin:/sbin"
    KUBECONFIG: "/home/victory/.kube/config"

  tasks:
    - name: ğŸš€ Iniciando desinstalaciÃ³n de Jenkins...
      debug:
        msg: "DesinstalaciÃ³n iniciada"

    - name: ğŸ§¹ Desinstalando Helm release de Jenkins
      shell: helm uninstall {{ jenkins_release_name }} -n {{ helm_namespace }} || true
      ignore_errors: true

    - name: ğŸ§¨ Eliminando namespace de Jenkins (si existe)
      shell: kubectl delete namespace {{ helm_namespace }} || true
      ignore_errors: true

    - name: âœ… ConfirmaciÃ³n final
      debug:
        msg: "Jenkins y el namespace '{{ helm_namespace }}' han sido eliminados correctamente."