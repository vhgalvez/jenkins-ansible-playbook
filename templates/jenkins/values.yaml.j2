# templates\jenkins\values.yaml.j2
controller:
  serviceType: ClusterIP  # Tipo de servicio Kubernetes (ClusterIP para acceso interno)
  servicePort: 8081  # Jenkins escucha en el puerto 8081 dentro de Kubernetes
  targetPort: 8081   # Puerto al que el servicio debe dirigir el tráfico (puerto real del contenedor)
  jenkinsOpts: ""    # Opciones adicionales, sin --prefix=/ para evitar problemas con rutas

  ingress:
    enabled: true  # Activar Ingress para Jenkins
    ingressClassName: traefik  # Asegura que Traefik maneje este Ingress
    hostName: "jenkins.cefaslocalserver.com"  # Nombre de dominio para acceder a Jenkins
    annotations:
      traefik.ingress.kubernetes.io/router.entrypoints: websecure  # Asegura que el tráfico pase por el puerto 443 (HTTPS)
      traefik.ingress.kubernetes.io/router.tls: "true"  # Activa TLS para habilitar HTTPS
      traefik.ingress.kubernetes.io/auth-type: basic  # Autenticación básica habilitada
      traefik.ingress.kubernetes.io/auth-secret: jenkins-auth-secret  # Secreto para la autenticación básica
    paths:
      - path: /  # Ruta para acceder a Jenkins
        pathType: Prefix  # Permite subrutas como /login, /static, etc.
        backend:
          service:
            name: jenkins  # El nombre del servicio de Jenkins en Kubernetes
            port:
              number: 8081  # El servicio está escuchando en el puerto 8081, que es el puerto real de Jenkins

  healthProbes:
    livenessProbe:
      httpGet:
        path: /login
        port: 8081  # Cambiar el puerto a 8081, que es el puerto donde Jenkins escucha
      initialDelaySeconds: 60
      periodSeconds: 10
      failureThreshold: 3
    readinessProbe:
      httpGet:
        path: /login
        port: 8081  # Cambiar el puerto a 8081
      initialDelaySeconds: 60
      periodSeconds: 10
      failureThreshold: 3
    startupProbe:
      httpGet:
        path: /login
        port: 8081  # Cambiar el puerto a 8081
      initialDelaySeconds: 60
      periodSeconds: 10
      failureThreshold: 30

  JCasC:
    enabled: false  # Desactivado si no usas configuración en código de Jenkins

  installPlugins: []  # Puedes agregar plugins de Jenkins aquí si es necesario