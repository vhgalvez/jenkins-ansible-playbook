# templates/jenkins/values.yaml.j2
controller:
  serviceType: ClusterIP
  servicePort: 8080
  jenkinsOpts: ""  # No usar --prefix=/ para evitar 404

  ingress:
    enabled: true
    ingressClassName: traefik
    hostName: "jenkins.local"
    annotations:
      traefik.ingress.kubernetes.io/router.entrypoints: websecure  # Solo HTTPS
      traefik.ingress.kubernetes.io/router.tls: "true"  # Habilitar TLS para HTTPS
      traefik.ingress.kubernetes.io/auth-type: basic  # Autenticación básica
      traefik.ingress.kubernetes.io/auth-secret: jenkins-auth-secret  # Secreto para autenticación básica
    paths:
      - path: /
        pathType: Prefix  # ✅ Permite subrutas como /login, /static, etc.
        backend:
          service:
            name: jenkins
            port:
              number: 8080
    tls:
      - hosts:
          - "jenkins.local"
        # Elimina 'secretName' para usar el certificado TLS gestionado por Traefik
        certResolver: default  # Usar el resolver ACME de Traefik para TLS

  healthProbes:
    livenessProbe:
      httpGet:
        path: /login
        port: 8080
      initialDelaySeconds: 60
      periodSeconds: 10
    readinessProbe:
      httpGet:
        path: /login
        port: 8080
      initialDelaySeconds: 60
      periodSeconds: 10
    startupProbe:
      httpGet:
        path: /login
        port: 8080
      failureThreshold: 30
      periodSeconds: 10

  JCasC:
    enabled: false  # Desactivado si no usas configuración en código de Jenkins

  installPlugins: []  # Puedes agregar plugins de Jenkins aquí si es necesario